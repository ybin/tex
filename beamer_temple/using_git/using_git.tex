\documentclass{beamer}

\input{beamer_template}
\input{tikz_template}

%********** title page settings **********
\title{Using GIT}
\author{孙延宾}
\institute{业务软件开发一部$\cdot$西安}
\date{\today}

\begin{document}

%*************** title page *****************
\begin{frame}[plain]
  \titlepage
\end{frame}
%*************** title page *****************

%%%%%%%%%%%%%%%%%%%%% Introduce %%%%%%%%%%%%%%%%%%%%%%%%%%
\part[Introduce]{Introduce}
\section[What is git]{What is git}
\begin{frame}{Introduce}
\begin{center}
  \begin{tikzpicture}
    %%% directory - 1
    \node[file-style] (a1) {\tiny a.h};
    \node[file-style,right=0.2cm of a1] (b1) {\tiny b.h};
    \node[file-style,right=0.2cm of b1] (c1) {\tiny c.h};
    \node[file-style,below=0.1cm of b1] (d1) {\tiny\textcolor{blue}{$d_{v1}.h$}};
    \node[dir-style,below=0.2cm of d1] (dir1) {\tiny directory-1};
    \begin{pgfonlayer}{background}
      \node [dir-bg-style,fit=(a1) (b1) (c1) (d1) (dir1)] {};
    \end{pgfonlayer}
    
    %%% directory - 2
    \node[file-style,right=1.5cm of c1] (a2) {\tiny a.h};
    \node[file-style,right=0.2cm of a2] (b2) {\tiny b.h};
    \node[file-style,right=0.2cm of b2] (c2) {\tiny c.h};
    \node[file-style,below=0.1cm of b2] (d2) {\tiny\textcolor{blue}{$d_{v2}.h$}};
    \node[dir-style,below=0.2cm of d2] (dir2) {\tiny directory-2};
    \begin{pgfonlayer}{background}
      \node [dir-bg-style,fit=(a2) (b2) (c2) (d2) (dir2)] {};
    \end{pgfonlayer}
    
    %%% directory - 3
    \node[file-style,right=1.5cm of c2] (a3) {\tiny a.h};
    \node[file-style,right=0.2cm of a3] (b3) {\tiny b.h};
    \node[file-style,right=0.2cm of b3] (c3) {\tiny c.h};
    \node[file-style,below=0.1cm of b3] (d3) {\tiny\textcolor{blue}{$d_{v3}.h$}};
    \node[dir-style,below=0.2cm of d3] (dir3) {\tiny directory-3};
    \begin{pgfonlayer}{background}
      \node [dir-bg-style,fit=(a3) (b3) (c3) (d3) (dir3)] {};
    \end{pgfonlayer}
    
    %%% working directory
    \node[file-style,below=3cm of dir2] (b4) {\tiny b.h};
    \node[file-style,left=0.2cm of b4] (a4) {\tiny a.h};
    \node[file-style,right=0.2cm of b4] (c4) {\tiny c.h};
    \node[file-style,below=0.1cm of b4] (d4) {\tiny d.h};
    \node[dir-style,below=0.2cm of d4] (dir4) {\tiny working dir};
    \begin{pgfonlayer}{background}
      \node [dir-bg-style,fit=(a4) (b4) (c4) (d4) (dir4)] {};
    \end{pgfonlayer}
    
    %%% arrows
    % dir-1 to dir2
    \path[->] ([xshift=1cm]d1.east) edge ([xshift=-1cm]d2.west);
    % dir-2 to dir3
    \path[->] ([xshift=1cm]d2.east) edge ([xshift=-1cm]d3.west);
    % working dir to dir1
    \path[->] ([yshift=0.4cm]b4.north west) edge node[right]{\tiny copy as v1} ([yshift=-0.4cm]dir1.south);
    % working dir to dir2
    \path[->] ([yshift=0.4cm]b4.north) edge node[right]{\tiny copy as v2} ([yshift=-0.4cm]dir2.south);
    % working dir to dir3
    \path[->] ([yshift=0.4cm]b4.north east) edge node[right]{\tiny copy as v3} ([yshift=-0.4cm]dir3.south);
  \end{tikzpicture}
\end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%% Local Operation %%%%%%%%%%%%%%%%%%%%%%%%
\part[Local Operations]{Local Operations}
\section[git add]{git add}
\begin{frame}{\ {}}
  \gitcmd{git add}
\end{frame}

\begin{frame}{git add}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;
    \createBranch name:master display:{\displayName master} direct:above to:e;
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path (work) edge[bend right=30] node[cmd-style=left]{\commandName git add files/directories} (index);
  \end{tikzpicture}
\end{center}
\end{frame}

\section[git commit]{git commit}
\begin{frame}{\ {}}
  \gitcmd{git commit}
\end{frame}

\begin{frame}{git commit}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;
    \createBranch name:master display:{\displayName master} direct:above to:e;
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path (index) edge[out=60,in=245] node[cmd-style=below,near end]{\commandName git commit} (e);
  \end{tikzpicture}
\end{center}
\end{frame}

\section[git checkout]{git checkout}
\begin{frame}{\ {}}
  \gitcmd{git checkout}
\end{frame}
\begin{frame}{git checkout}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;
    \createBranch name:master display:{\displayName master} direct:above to:e;
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path (index) edge[bend right=30] node[cmd-style=left]{\commandName git checkout -- files} (work);
    \path (e.south) edge[bend left=45] node[circle,fill=red,swap,auto,inner sep=1pt] {\tiny{1}}
      node[cmd-style=left,swap,pos=0.15]{\commandName git checkout E} (index.east);
    \path (e.south) edge[bend left=45]
      node[circle,fill=red,auto,swap,inner sep=1pt] {\tiny{2}} (work.east);
  \end{tikzpicture}
\end{center}
\end{frame}

\section[git reset]{git reset}
\begin{frame}{\ {}}
  \gitcmd{git reset}
\end{frame}

\begin{frame}{git reset \texttt{-{}-} files}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;
    \createBranch name:master display:{\displayName master} direct:above to:e;
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path (e.south) edge[out=270,in=0] node[cmd-style=above,auto,swap]{\commandName git reset -- files} (index.east);
  \end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}{git reset \texttt{-{}-}soft commit}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;

    % create old master branch & HEAD
    \path <1> node [branch-style, above=0.75\commitDistance of e] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (e);
    % create new master branch & HEAD
    \path <2> node [branch-style, above=0.75\commitDistance of d] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (d);
    \path <2-> (e.north west) edge[bend right=30,<->] (d.north east);
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;
  \end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}{git reset \texttt{-{}-}mixed commit}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;

    % create old master branch & HEAD
    \path <1> node [branch-style, above=0.75\commitDistance of e] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (e);
    % create new master branch & HEAD
    \path <2-> node [branch-style, above=0.75\commitDistance of d] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (d);
    \path <2-> (e.north west) edge[bend right=30,<->] node[circle,above,auto,swap,fill=red,inner sep=1pt]{\tiny{1}}
                (d.north east);
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path <3-> (e.south) edge[bend left=45] node[circle,fill=red,swap,auto,inner sep=1pt] {\tiny{2}}(index.east);
  \end{tikzpicture}
\end{center}
\end{frame}

\begin{frame}{git reset \texttt{-{}-}hard commit}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:b;

    % create old master branch & HEAD
    \path <1> node [branch-style, above=0.75\commitDistance of e] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (e);
    % create new master branch & HEAD
    \path <2-> node [branch-style, above=0.75\commitDistance of d] (master) {master}
        edge [cmd-style, BRANCHCOLOR] (d);
    \path <2-> (e.north west) edge[bend right=30,<->] node[circle,above,auto,swap,fill=red,inner sep=1pt]{\tiny{1}}
                (d.north east);
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path <3-> (e.south) edge[bend left=45] node[circle,fill=red,swap,auto,inner sep=1pt] {\tiny{2}}(index.east);
    \path <4-> (e.south) edge[bend left=45]
      node[circle,fill=red,auto,swap,inner sep=1pt] {\tiny{3}} (work.east);
  \end{tikzpicture}
\end{center}
\end{frame}

\section[git diff]{git diff}
\begin{frame}{\ {}}
  \gitcmd{git diff}
\end{frame}

\begin{frame}{git diff}
\begin{center}
  \begin{tikzpicture}[main-style]
    \makeOutline
    \createBranch name:release display:{\displayName release} direct:above to:a;
    \createBranch name:master display:{\displayName master} direct:above to:e;
    \createHead direct:above to:master;

    \createIndex to:c;
    \createWork to:index;

    \path <1-> (work.north west) edge[bend left=45,<->] node[left]{\displayName git diff file} (index.south west);
    \path <2-> (index.east) edge[bend right=45,<->] node[above,auto,near end]{\displayName git diff --cached file} (e.south);
    \path <3-> (work.east) edge[bend right=45,<->] node[above,auto,pos=0.4]{\displayName git diff E file} (e.-70);
    \path <4-> (b.north east) edge[bend left=30,<->] node[above,auto]{\displayName git diff B..D file} (d.north west);
  \end{tikzpicture}
\end{center}
\end{frame}


\part[Remote Operations]{Remote Operations}
\section[git fetch]{git fetch}
\begin{frame}{git fetch}
\end{frame}


\part[Tips \& Tricks]{Tips \& Tricks}
\section[fetch a single branch]{fetch a single branch}
\begin{frame}{fetch a single branch}
\end{frame}


\end{document}
